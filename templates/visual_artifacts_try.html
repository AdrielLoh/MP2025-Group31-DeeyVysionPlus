<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Try Visual Artifacts Detection</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">


    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let form = document.getElementById("upload-form");
            let spinner = document.getElementById("loadingSpinner");

            form.addEventListener("submit", function(event) {
                event.preventDefault();

                // Disable the button and change text
                submitButton.disabled = true;
                submitButton.innerText = "Processing...";

                // Show the spinner
                spinner.style.display = "block";

                // Submit the form normally
                form.setAttribute("action", "/visual_artifacts_static");
                form.setAttribute("method", "POST");
                form.submit();
            });
        });
    </script>
</head>
<body>
    <header>
        <div id="navbar-placeholder"></div>
    </header>
    
    <section class="content">
        <div class="page-intro">
            <h1>Try Visual Artefacts Detection</h1>
            <p>This visual artefacts detection analyzes inconsistencies in facial geometry, facial landmarks, and video artefacts. 
                Results may vary based on video quality and lighting conditions, and should not be taken as the complete truth.</p>
        </div>

        <div class="detection-methods">
            <!-- File Upload Method -->
            <div class="detection-method">
                <div class="method-header">
                    <div class="method-icon">üìÅ</div>
                    <h2 class="method-title">Upload Video File</h2>
                </div>
                <p class="method-description">Upload a video file from your device for analysis. Supports .mp4 format.</p>
                
                <form id="upload-form" enctype="multipart/form-data">
                    <div id="dropbox" class="dropbox">
                        <p>Drag & drop a video file here, or click to select one</p>
                        <input type="file" name="file" id="file" accept="video/*" required>
                        <video id="video-preview" controls style="display: none;"></video>
                    </div>
                    <button type="submit" id="submitButton">Analyze Video</button>
                    <div id="loadingSpinner">
                        <div class="spinner"></div>
                        <p>Processing video... Please wait.</p>
                    </div>
                </form>
            </div>

            <!-- Webcam Detection Method -->
            <div class="detection-method">
                <div class="method-header">
                    <div class="method-icon">üìπ</div>
                    <h2 class="method-title">Live Webcam Detection</h2>
                </div>
                <p class="method-description">Use your webcam for real-time detection. Record a short video clip and analyze it instantly.</p>
                
                <div class="webcam-controls">
                    <div class="camera-selection">
                        <label for="videoSource">Select Camera:</label>
                        <select id="videoSource"></select>
                    </div>
                    
                    <div class="webcam-preview-container">
                        <video id="webcam-preview" width="400" autoplay muted style="display: none;"></video>
                    </div>
                    
                    <div class="webcam-buttons">
                        <button id="startWebcamBtn" class="button">Start Recording</button>
                        <button id="stopWebcamBtn" class="button" disabled>Stop & Analyze</button>
                    </div>
                    
                    <div id="webcamSpinner" style="display:none;">
                        <div class="spinner"></div>
                        <p>Processing live video...</p>
                    </div>
                </div>
                
                <form id="webcamUploadForm" method="POST" enctype="multipart/form-data" action="/visual_artifacts_static" style="display:none;">
                    <input type="file" name="file" id="webcamFileInput">
                    <button type="submit">Upload and Analyze</button>
                </form>
            </div>
        </div>

        <script src="../static/js/live-webcam.js"></script>
    </section>
    <footer>
        <div id="footer-placeholder"></div>
    </footer>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>
