<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detection Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/new_styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/result.css') }}">
</head>
<body>
    <header>
        <div id="navbar-placeholder"></div>
    </header>

    <main class="results-main">
        <!-- Hero Section -->
        <section class="results-hero">
            <div class="hero-background">
                <div class="pulse-waves"></div>
                <div class="floating-particles"></div>
            </div>
            <div class="hero-content">
                <div class="results-icon">
                    <div class="detection-pulse"></div>
                    {% if analysis_type == 'audio' %}
                        <span class="icon-emoji">üéµ</span>
                    {% elif analysis_type in ['physiological', 'visual_artifacts', 'visual_artifact_static'] %}
                        <span class="icon-emoji">üëÅÔ∏è</span>
                    {% elif analysis_type in ['deep_learning', 'deep_learning_static'] %}
                        <span class="icon-emoji">üß†</span>
                    {% elif analysis_type in ['body_posture', 'body_posture_live'] %}
                        <span class="icon-emoji">ü§ñ</span>
                    {% elif analysis_type == 'multi_detection' %}
                        <span class="icon-emoji">üîç</span>
                    {% else %}
                        <span class="icon-emoji">üî¨</span>
                    {% endif %}
                </div>
                <h1 class="results-title">Detection Analysis Complete</h1>
                <p class="results-subtitle">Deepfake Detection Results are shown below</p>
            </div>
        </section>

        <!-- Main Results Container -->
        <div class="results-container">
            
            {% if analysis_type == 'audio' %}
                <!-- Audio Detection Results -->
                <div class="result-card audio-result">
                    <div class="result-header">
                        <div class="result-status">
                            <h2 class="status-text" style="color:{% if result == 'Bonafide' %}#10b981{% elif result == 'Spoof' %}#ef4444{% else %}#f59e0b{% endif %};">
                                {{ result }}
                            </h2>
                            <div class="confidence-badge">
                                <span class="confidence-label">Chance of Deepfake:</span>
                                <span class="confidence-value">{{ prediction_value }}%</span>
                            </div>
                        </div>
                        <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                            <span>‚Üê</span> Return to Analysis
                        </button>
                    </div>

                    {% if uploaded_audio %}
                    <div class="audio-playback">
                        <h3>Audio Sample</h3>
                        <p class="audio-description">Listen to the analyzed audio file:</p>
                        <div class="audio-container">
                            <audio class="analysis-audio" controls preload="metadata">
                                <source src="{{ uploaded_audio }}" type="audio/wav">
                                Your browser does not support the audio element.
                            </audio>
                        </div>
                    </div>
                    {% endif %}

                    {% if mel_spectrogram_path or mfcc_path or delta_path or f0_path %}
                    <div class="analysis-tabs">
                        <div class="tab-navigation">
                            {% if mel_spectrogram_path %}<button class="tab-btn active" data-tab="mel-spectrogram">Mel Spectrogram</button>{% endif %}
                            {% if mfcc_path %}<button class="tab-btn" data-tab="mfcc">MFCC</button>{% endif %}
                            {% if delta_path %}<button class="tab-btn" data-tab="delta-mfcc">Delta MFCC</button>{% endif %}
                            {% if f0_path %}<button class="tab-btn" data-tab="f0">Pitch Analysis</button>{% endif %}
                        </div>

                        {% if mel_spectrogram_path %}
                        <div class="tab-panel active" id="mel-spectrogram">
                            <div class="analysis-content">
                                <h3>Mel Spectrogram Analysis</h3>
                                <p class="analysis-description">Frequency distribution and energy patterns over time, revealing potential deepfake artifacts in the audio spectrum.</p>
                                <div class="chart-container">
                                    <img src="{{ url_for('static', filename=mel_spectrogram_path) }}" alt="Mel Spectrogram" class="analysis-chart">
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        {% if mfcc_path %}
                        <div class="tab-panel" id="mfcc">
                            <div class="analysis-content">
                                <h3>MFCC Analysis</h3>
                                <p class="analysis-description">Mel Frequency Cepstral Coefficients capturing vocal tract characteristics and speech patterns.</p>
                                <div class="chart-container">
                                    <img src="{{ url_for('static', filename=mfcc_path) }}" alt="MFCC" class="analysis-chart">
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        {% if delta_path %}
                        <div class="tab-panel" id="delta-mfcc">
                            <div class="analysis-content">
                                <h3>Delta MFCC Analysis</h3>
                                <p class="analysis-description">Rate of change in speech dynamics, detecting unnatural transitions common in synthetic audio.</p>
                                <div class="chart-container">
                                    <img src="{{ url_for('static', filename=delta_path) }}" alt="Delta MFCC" class="analysis-chart">
                                </div>
                            </div>
                        </div>
                        {% endif %}

                        {% if f0_path %}
                        <div class="tab-panel" id="f0">
                            <div class="analysis-content">
                                <h3>Pitch Analysis</h3>
                                <p class="analysis-description">Fundamental frequency patterns revealing pitch inconsistencies and monotonic patterns in synthetic speech.</p>
                                <div class="chart-container">
                                    <img src="{{ url_for('static', filename=f0_path) }}" alt="Pitch" class="analysis-chart">
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>

            {% elif analysis_type == 'physiological' %}
                <!-- Physiological Detection Results -->
                {% if face_results|length == 0 %}
                    <div class="result-card error-result">
                        <div class="result-header">
                            <div class="result-status">
                                <h2 class="status-text" style="color: #f59e0b;">No Faces Detected</h2>
                                <p class="error-message">Unable to detect faces in the provided video. Please try with a clearer video containing visible faces (minimum 5 seconds recommended).</p>
                            </div>
                            <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                <span>‚Üê</span> Try Again
                            </button>
                        </div>
                    </div>
                {% else %}
                    <div class="face-detection-results">
                        <div class="face-tabs">
                            <div class="tab-navigation">
                                {% for face in face_results %}
                                <button class="tab-btn{% if loop.first %} active{% endif %}" data-tab="face-{{ face.track_id }}">
                                    Face #{{ face.track_id }}
                                </button>
                                {% endfor %}
                            </div>
                        </div>

                        {% for face in face_results %}
                        <div class="result-card physiological-result tab-panel{% if loop.first %} active{% endif %}" id="face-{{ face.track_id }}">
                            <div class="result-header">
                                <div class="result-status">
                                    <h2 class="status-text" style="color: {% if face.result == 'Real' %}#10b981{% elif face.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                        {% if face.result == 'Real' %}Authentic{% elif face.result == 'Fake' %}Likely Deepfake{% elif face.result == 'Invalid' %}Video too short{% else %}Inconclusive{% endif %}
                                    </h2>
                                    <div class="metrics-grid">
                                        <div class="metric-item">
                                            <span class="metric-label">Real Frames:</span>
                                            <span class="metric-value">{{ face.real_count }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Fake Frames:</span>
                                            <span class="metric-value">{{ face.fake_count }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Chance of Deepfake:</span>
                                            <span class="metric-value">{{ face.confidence }}%</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                    <span>‚Üê</span> Return to Analysis
                                </button>
                            </div>

                            {% if face.result == "Invalid" %}
                            <h3>The video needs to be at least 3 seconds for effective physiological features</h3>
                            {% endif %}

                            {% if face.result != 'Invalid' %}
                            <div class="video-analysis">
                                <h3>Analyzed Video</h3>
                                <video class="analysis-video" controls autoplay loop muted>
                                    <source src="{{ output_video }}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>
                            {% endif %}

                            <div class="analysis-carousel">
                                <div class="carousel-header">
                                    <h3 style="color: var(--warning-gradient)">Physiological Analysis Charts</h3>
                                    <div class="carousel-controls">
                                        <button class="carousel-btn prev" data-carousel="carousel-{{ face.track_id }}">‚Äπ</button>
                                        <button class="carousel-btn next" data-carousel="carousel-{{ face.track_id }}">‚Ä∫</button>
                                    </div>
                                </div>
                                {% if physio_method == 'deep' and face.result != 'Invalid' %}
                                <div class="carousel-container" id="carousel-{{ face.track_id }}">
                                    <div class="carousel-track">
                                        <div class="carousel-slide active">
                                            <img src="{{ face.roi_signal_plots.left_cheek }}" alt="left_cheek" class="analysis-chart">
                                            <p class="chart-description">Raw rPPG Signals from the left cheek</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ face.roi_signal_plots.right_cheek }}" alt="right_cheek" class="analysis-chart">
                                            <p class="chart-description">Raw rPPG Signals from the right cheek</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ face.roi_signal_plots.forehead }}" alt="forehead" class="analysis-chart">
                                            <p class="chart-description">Raw rPPG Signals from the forehead</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ face.roi_signal_plots.chin }}" alt="chin" class="analysis-chart">
                                            <p class="chart-description">Raw rPPG Signals from the chin</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ face.roi_signal_plots.nose }}" alt="nose" class="analysis-chart">
                                            <p class="chart-description">Raw rPPG Signals from the nose</p>
                                        </div>
                                    </div>
                                </div>
                                {% elif physio_method =='machine' and face.result != 'Invalid' %}
                                <div class="carousel-container" id="carousel-{{ face.track_id }}">
                                    <div class="carousel-track">
                                        {% if face.hr_trace_plot %}
                                        <div class="carousel-slide active">
                                            <img src="{{ face.hr_trace_plot }}" alt="rPPG Signal Analysis" class="analysis-chart">
                                            <p class="chart-description">Real-time photoplethysmography signal analysis</p>
                                        </div>
                                        {% endif %}
                                        
                                        {% if face.hr_dist_plot %}
                                        <div class="carousel-slide{% if not face.hr_trace_plot %} active{% endif %}">
                                            <img src="{{ face.hr_dist_plot }}" alt="Heart Rate Distribution" class="analysis-chart">
                                            <p class="chart-description">Heart rate distribution patterns</p>
                                        </div>
                                        {% endif %}
                                        
                                        {% if face.band_power_plot %}
                                        <div class="carousel-slide{% if not face.hr_trace_plot and not face.hr_dist_plot %} active{% endif %}">
                                            <img src="{{ face.band_power_plot }}" alt="Frequency Band Power" class="analysis-chart">
                                            <p class="chart-description">Frequency band power analysis</p>
                                        </div>
                                        {% endif %}
                                        
                                        {% if face.spectrum_plot %}
                                        <div class="carousel-slide">
                                            <img src="{{ face.spectrum_plot }}" alt="Signal Spectrum" class="analysis-chart">
                                            <p class="chart-description">rPPG signal spectrum analysis</p>
                                        </div>
                                        {% endif %}
                                        
                                        {% if face.signal_plot %}
                                        <div class="carousel-slide">
                                            <img src="{{ face.signal_plot }}" alt="Raw Signal" class="analysis-chart">
                                            <p class="chart-description">Raw physiological signal data</p>
                                        </div>
                                        {% endif %}
                                        
                                        {% if face.pred_count_plot %}
                                        <div class="carousel-slide">
                                            <img src="{{ face.pred_count_plot }}" alt="Prediction Distribution" class="analysis-chart">
                                            <p class="chart-description">Frame-by-frame prediction distribution</p>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% endif %}

            {% elif analysis_type in ['deep_learning', 'deep_learning_static'] %}
                <!-- Deep Learning Detection Results -->
                {% if face_results|length == 0 %}
                    <div class="result-card error-result">
                        <div class="result-header">
                            <div class="result-status">
                                <h2 class="status-text" style="color: #f59e0b;">No Faces Detected</h2>
                                <p class="error-message">Unable to detect faces in the provided video. Please try with a clearer video containing visible faces (minimum 5 seconds recommended).</p>
                            </div>
                            <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                <span>‚Üê</span> Try Again
                            </button>
                        </div>
                    </div>
                {% else %}
                    <div class="face-detection-results">
                        <div class="face-tabs">
                            <div class="tab-navigation">
                                {% for face in face_results %}
                                <button class="tab-btn{% if loop.first %} active{% endif %}" data-tab="face-{{ face.track_id }}">
                                    Face #{{ face.track_id }}
                                </button>
                                {% endfor %}
                            </div>
                        </div>

                        {% for face in face_results %}
                        <div class="result-card deep-learning-result tab-panel{% if loop.first %} active{% endif %}" id="face-{{ face.track_id }}">
                            <div class="result-header">
                                <div class="result-status">
                                    <h2 class="status-text" style="color: {% if face.result == 'Real' %}#10b981{% elif face.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                        {% if face.result == 'Real' %}Authentic{% elif face.result == 'Fake' %}Likely Deepfake{% else %}Inconclusive{% endif %}
                                    </h2>
                                    <div class="metrics-grid">
                                        <div class="metric-item">
                                            <span class="metric-label">Real Frames:</span>
                                            <span class="metric-value">{{ face.real_count }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Fake Frames:</span>
                                            <span class="metric-value">{{ face.fake_count }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Chance of Deepfake:</span>
                                            <span class="metric-value">{{ face.confidence }}%</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                    <span>‚Üê</span> Return to Analysis
                                </button>
                            </div>

                            <div class="video-analysis">
                                <h3>Analyzed Video</h3>
                                <video class="analysis-video" controls autoplay loop muted>
                                    <source src="{{ output_video }}" type="video/mp4">
                                    Your browser does not support the video tag.
                                </video>
                            </div>

                            <div class="analysis-carousel">
                                <div class="carousel-header">
                                    <h3 style="color: var(--warning-gradient)">Deep Learning Analysis Charts</h3>
                                    <div class="carousel-controls">
                                        <button class="carousel-btn prev" data-carousel="carousel-{{ face.track_id }}">‚Äπ</button>
                                        <button class="carousel-btn next" data-carousel="carousel-{{ face.track_id }}">‚Ä∫</button>
                                    </div>
                                </div>
                                <div class="carousel-container" id="carousel-{{ face.track_id }}">
                                    <div class="carousel-track">
                                        <div class="carousel-slide active">
                                            <img src="{{ face.conf_plot }}" alt="Confidence Score Over Time" class="analysis-chart">
                                            <p class="chart-description">Confidence score progression throughout the video</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ face.real_vs_fake_plot }}" alt="Real vs Fake Classification" class="analysis-chart">
                                            <p class="chart-description">Frame-by-frame classification results</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% endif %}

            {% elif analysis_type in ['visual_artifacts', 'visual_artifact_static'] %}
                <!-- Visual Artifacts Detection Results -->
                {% if analysis_type == 'visual_artifacts' and face_results|length == 0 %}
                    <div class="result-card error-result">
                        <div class="result-header">
                            <div class="result-status">
                                <h2 class="status-text" style="color: #f59e0b;">No Faces Detected</h2>
                                <p class="error-message">Unable to detect faces in the provided video. Please try with a clearer video containing visible faces (minimum 5 seconds recommended).</p>
                            </div>
                            <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                <span>‚Üê</span> Try Again
                            </button>
                        </div>
                    </div>
                {% else %}
                    {% if analysis_type == 'visual_artifacts' %}
                        <div class="face-detection-results">
                            <div class="face-tabs">
                                <div class="tab-navigation">
                                    {% for face in face_results %}
                                    <button class="tab-btn{% if loop.first %} active{% endif %}" data-tab="face-{{ face.track_id }}">
                                        Face #{{ face.display_id }}
                                    </button>
                                    {% endfor %}
                                </div>
                            </div>
                            {% for face in face_results %}
                            <div class="result-card visual-result tab-panel{% if loop.first %} active{% endif %}" id="face-{{ face.track_id }}">
                                <div class="result-header">
                                    <div class="result-status">
                                        <h2 class="status-text" style="color: {% if face.result == 'Real' %}#10b981{% elif face.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                            {% if face.result == 'Real' %}Authentic{% elif face.result == 'Fake' %}Likely Deepfake{% else %}Inconclusive{% endif %}
                                        </h2>
                                        <div class="metrics-grid">
                                            <div class="metric-item">
                                                <span class="metric-label">Real Frames:</span>
                                                <span class="metric-value">{{ face.real_count }}</span>
                                            </div>
                                            <div class="metric-item">
                                                <span class="metric-label">Fake Frames:</span>
                                                <span class="metric-value">{{ face.fake_count }}</span>
                                            </div>
                                            <div class="metric-item">
                                                <span class="metric-label">Chance of Deepfake:</span>
                                                <span class="metric-value">{{ face.confidence }}%</span>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                        <span>‚Üê</span> Return to Analysis
                                    </button>
                                </div>
                                <div class="video-analysis">
                                    <h3>Analyzed Video</h3>
                                    <video class="analysis-video" controls autoplay loop muted>
                                        <source src="{{ url_for('static', filename=video_with_boxes) }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                                <div class="analysis-carousel">
                                    <div class="carousel-header">
                                        <h3 style="color: var(--warning-gradient)">Visual Artifact Analysis</h3>
                                        <div class="carousel-controls">
                                            <button class="carousel-btn prev" data-carousel="carousel-{{ face.track_id }}">‚Äπ</button>
                                            <button class="carousel-btn next" data-carousel="carousel-{{ face.track_id }}">‚Ä∫</button>
                                        </div>
                                    </div>
                                    <div class="carousel-container" id="carousel-{{ face.track_id }}">
                                        <div class="carousel-track">
                                            {% for chart in face.charts %}
                                            <div class="carousel-slide{% if loop.first %} active{% endif %}">
                                                <img src="{{ url_for('static', filename=chart) }}" alt="Visual Analysis Chart" class="analysis-chart">
                                                <p class="chart-description">Visual artifact detection analysis</p>
                                            </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>

                    {% else %}
                        <!-- Static Visual Artifacts -->
                        <div class="result-card visual-result">
                            <div class="result-header">
                                <div class="result-status">
                                    <h2 class="status-text" style="color: {% if result == 'Real' %}#10b981{% elif result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                        {% if result == 'Real' %}Authentic{% elif result == 'Fake' %}Likely Deepfake{% else %}Inconclusive{% endif %}
                                    </h2>
                                    <div class="metrics-grid">
                                        <div class="metric-item">
                                            <span class="metric-label">Real Frames:</span>
                                            <span class="metric-value">{{ real_count }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Fake Frames:</span>
                                            <span class="metric-value">{{ fake_count }}</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                    <span>‚Üê</span> Return to Analysis
                                </button>
                            </div>

                            <div class="analysis-charts">
                                <div class="chart-item">
                                    <h3>Visual Artifact Detection</h3>
                                    <div class="chart-container">
                                        <img src="{{ url_for('static', filename='results/real_vs_fake.png') }}" alt="Visual Analysis" class="analysis-chart">
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
            <!-- Body Posture Analysis -->
            {% elif analysis_type in ['body_posture', 'body_posture_live'] %}
                {% if results.error %}
                    <div class="result-card error-result">
                        <div class="result-header">
                            <div class="result-status">
                                <h2 class="status-text" style="color: #f59e0b;">No Faces Detected</h2>
                                <p class="error-message">Unable to detect faces in the provided video. Please try with a clearer video containing visible faces (minimum 5 seconds recommended).</p>
                            </div>
                            <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                <span>‚Üê</span> Try Again
                            </button>
                        </div>
                    </div>
                {% endif %}
                {% if analysis_type == 'body_posture' %}
                    <div class="result-card body-posture-result tab-panel active">
                        <div class="result-header">
                            <div class="result-status">
                                <h2 class="status-text" style="color: {% if overall_result.prediction == 'Realistic' %}#10b981{% elif overall_result.prediction == 'Unrealistic' %}#ef4444{% else %}#f59e0b{% endif %};">
                                    {% if overall_result.prediction == 'Realistic' %}Realistic{% elif overall_result.prediction == 'Unrealistic' %}Unrealistic{% elif overall_result.prediction == 'Invalid' %}Video too short{% else %}Inconclusive{% endif %}
                                </h2>
                                <div class="metrics-grid">
                                    <div class="metric-item">
                                        <span class="metric-label">Person Count:</span>
                                        <span class="metric-value">{{ overall_result.person_count }}</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Overall keypoint Instability:</span>
                                        <span class="metric-value">{{ overall_result.overall_instability }}</span>
                                    </div>
                                </div>
                                <div class="analysis-carousel">
                                    <div class="carousel-header">
                                        <h3 style="color: var(--warning-gradient)">Overall Body Posture Analysis</h3>
                                        <div class="carousel-controls">
                                            <button class="carousel-btn prev" data-carousel="carousel-overall">‚Äπ</button>
                                            <button class="carousel-btn next" data-carousel="carousel-overall">‚Ä∫</button>
                                        </div>
                                    </div>
                                    <div class="carousel-container" id="carousel-overall">
                                        <div class="carousel-track">
                                            <div class="carousel-slide active">
                                                <img src="{{ overall_result.get('overall_figure') }}" alt="what" class="analysis-chart">
                                                <p class="chart-description">Overall Figure</p>
                                            </div>
                                            <div class="carousel-slide">
                                                <video class="analysis-video" controls autoplay loop muted>
                                                    <source src="{{ overall_result.get('overall_video') }}" type="video/mp4">
                                                    Your browser does not support the video tag.
                                                </video>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="face-detection-results">
                        <div class="face-tabs">
                            <div class="tab-navigation">
                                {% for person in results %}
                                    <button class="tab-btn{% if loop.first %} active{% endif %}" data-tab="face-{{ person.person_id }}">
                                        Person #{{ person.person_id }}
                                    </button>
                                {% endfor %}
                            </div>
                        </div>

                        {% for person in results %}
                        <div class="result-card body-posture-result tab-panel{% if loop.first %} active{% endif %}" id="face-{{ person.person_id }}">
                            <div class="result-header">
                                <div class="result-status">
                                    <h2 class="status-text" style="color: {% if person.result == 'Real' %}#10b981{% elif person.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                        {% if person.result == 'Real' %}Realistic{% elif person.result == 'Fake' %}Unrealistic{% elif person.result == 'Invalid' %}Video too short{% else %}Inconclusive{% endif %}
                                    </h2>
                                    <div class="metrics-grid">
                                        <div class="metric-item">
                                            <span class="metric-label">Result Confidence:</span>
                                            <span class="metric-value">{{ person.result_confidence }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Person Track Length:</span>
                                            <span class="metric-value">{{ person.track_length }}</span>
                                        </div>
                                    </div>
                                </div>
                                <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                                    <span>‚Üê</span> Return to Analysis
                                </button>
                            </div>
                            <div class="analysis-carousel">
                                <div class="carousel-header">
                                    <h3 style="color: var(--warning-gradient)">Body Posture Analysis Charts</h3>
                                    <div class="carousel-controls">
                                        <button class="carousel-btn prev" data-carousel="carousel-{{ person.person_id }}">‚Äπ</button>
                                        <button class="carousel-btn next" data-carousel="carousel-{{ person.person_id }}">‚Ä∫</button>
                                    </div>
                                </div>
                                <div class="carousel-container" id="carousel-{{ person.person_id }}">
                                    <div class="carousel-track">
                                        <div class="carousel-slide active">
                                            <img src="{{ person.figure_location[0] }}" alt="joint visibility" class="analysis-chart">
                                            <p class="chart-description">Joint Visibility</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ person.figure_location[1] }}" alt="joint confidence" class="analysis-chart">
                                            <p class="chart-description">Joint Confidence</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <img src="{{ person.figure_location[2] }}" alt="joint instability" class="analysis-chart">
                                            <p class="chart-description">Joint Instability</p>
                                        </div>
                                        <div class="carousel-slide">
                                            <video class="analysis-video" controls autoplay loop muted>
                                                <source src="{{ person.video_location }}" type="video/mp4" alt="person video">
                                                Your browser does not support the video tag.
                                            </video>
                                            <p class="chart-description">Extracted Person</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    {% if analysis_type == 'body_posture_live' %}
                    <div class="analysis-charts">
                        <div class="chart-item">
                            <h3 style="color: var(--warning-gradient)">Posture Analysis</h3>
                            <div class="chart-container">
                                <img src="{{ url_for('static', filename='results/frames_real_vs_fake.png') }}" alt="Posture Analysis" class="analysis-chart">
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
                {% endif %}

            {% elif analysis_type == 'multi_detection' %}
            <!-- Multi-Detection Results -->
            <div class="multi-detection-results">
                <div class="detection-tabs">
                    <div class="tab-navigation">
                        {% set method_names = {'deep_learning': 'Deep Learning', 'visual_artifacts': 'Visual Artifacts', 'physiological': 'Physiological', 'body_posture': 'Body Posture', 'audio': 'Audio'} %}
                        {% for method, data in multi_results.items() %}
                        <button class="tab-btn{% if loop.first %} active{% endif %}" data-tab="multi-{{ method }}">
                            {{ method_names.get(method, method.replace("_", " ").title()) }}
                        </button>
                        {% endfor %}
                    </div>
                </div>

                {% for method, data in multi_results.items() %}
                <div class="result-card multi-result tab-panel{% if loop.first %} active{% endif %}" id="multi-{{ method }}">
                    <div class="result-header">
                        <div class="result-status">
                            <div class="method-label">{{ method_names.get(method, method.replace("_", " ").title()) }}</div>
                            
                            {% if data.get('error') %}
                                <h2 class="status-text" style="color: #f59e0b;">Error</h2>
                                <p class="error-message">{{ data.error }}</p>
                            {% else %}
                                <h2 class="status-text" style="color: {% if data.prediction == 'Real' %}#10b981{% elif data.prediction == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                    {% if data.prediction == 'Real' %}Authentic{% elif data.prediction == 'Fake' %}Likely Deepfake{% else %}{{ data.prediction }}{% endif %}
                                </h2>
                                
                                <!-- Show method-specific metrics -->
                                {% if method == 'body_posture' and data.confidence is defined %}
                                    <div class="confidence-badge">
                                        <span class="confidence-label">Deepfake Probability:</span>
                                        <span class="confidence-value">{{ (data.confidence * 100) | round }}%</span>
                                    </div>
                                {% elif method in ['physiological', 'visual_artifacts', 'deep_learning', 'deep_learning_static'] and data.face_results %}
                                    <div class="metrics-grid">
                                        {% set total_real = data.face_results | selectattr('result', 'equalto', 'Real') | list | length %}
                                        {% set total_fake = data.face_results | selectattr('result', 'equalto', 'Fake') | list | length %}
                                        <div class="metric-item">
                                            <span class="metric-label">Real Faces:</span>
                                            <span class="metric-value">{{ total_real }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Fake Faces:</span>
                                            <span class="metric-value">{{ total_fake }}</span>
                                        </div>
                                        <div class="metric-item">
                                            <span class="metric-label">Total Faces:</span>
                                            <span class="metric-value">{{ data.face_results | length }}</span>
                                        </div>
                                    </div>
                                {% elif method == 'audio' and data.prediction_value is defined %}
                                    <div class="confidence-badge">
                                        <span class="confidence-label">Deepfake Probability:</span>
                                        <span class="confidence-value">{{ data.prediction_value }}%</span>
                                    </div>
                                {% endif %}
                            {% endif %}
                            
                            <p class="method-description">{{ method_names.get(method, method.replace("_", " ").title()) }} detection algorithm result</p>
                        </div>
                        <button class="action-button back-btn" onclick="deleteFilesAndGoBack();">
                            <span>‚Üê</span> Return to Analysis
                        </button>
                    </div>

                    {% if not data.get('error') %}
                        {% if method=='audio' %}
                            <div class="audio-playback">
                                <h3>Audio Sample</h3>
                                <p class="audio-description">Listen to the analyzed audio file:</p>
                                <div class="audio-container">
                                    <audio class="analysis-audio" controls preload="metadata">
                                        <source src="{{ data.uploaded_audio }}" type="audio/wav">
                                    </audio>
                                </div>
                            </div>
                            <div class="analysis-charts">
                                <div class="chart-grid">
                                    <div class="chart-item">
                                        <h3>Mel Spectrogram</h3>
                                        <div class="chart-container">
                                            <img src="static/{{ data.mel_spectrogram_path }}" alt="Mel Spectrogram" class="analysis-chart">
                                        </div>
                                    </div>
                                    <div class="chart-item">
                                        <h3>MFCC Plot</h3>
                                        <div class="chart-container">
                                            <img src="static/{{ data.mfcc_path }}" alt="MFCC" class="analysis-chart">
                                        </div>
                                    </div>
                                    <div class="chart-item">
                                        <h3>Delta MFCC</h3>
                                        <div class="chart-container">
                                            <img src="static/{{ data.delta_path }}" alt="Delta MFCC" class="analysis-chart">
                                        </div>
                                    </div>
                                    <div class="chart-item">
                                        <h3>Fundamental Frequency</h3>
                                        <div class="chart-container">
                                            <img src="static/{{ data.f0_path }}" alt="F0" class="analysis-chart">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}

                        {% if method == 'body_posture' and data.results %}
                            <div class="face-summary">
                                <h3>Body Posture Detection Summary</h3>
                                <div class="overall-metrics">
                                    <div class="metric-item">
                                        <span class="metric-label">Person Count:</span>
                                        <span class="metric-value">{{ data.overall_result.person_count }}</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Overall Prediction:</span>
                                        <span class="metric-value">{{ data.overall_result.prediction }}</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">Deepfake Probability:</span>
                                        <span class="metric-value">{{ data.overall_result.confidence }}</span>
                                    </div>
                                </div>
                                
                                <div class="face-grid">
                                    {% for person in data.results %}
                                        <div class="face-summary-card">
                                            <div class="face-id">Person #{{ person.person_id }}</div>
                                            <div class="person-result" style="color: {% if person.result == 'Real' %}#10b981{% elif person.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                                {{ person.result }}
                                            </div>
                                            <div class="face-confidence">
                                                Confidence: {{ person.result_confidence }}
                                            </div>
                                            <div class="track-length">
                                                Track Length: {{ person.track_length }} frames
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>

                            {% if data.overall_result.overall_video %}
                                <div class="video-analysis">
                                    <h3>Overall Analysis Video</h3>
                                    <video class="analysis-video" controls autoplay loop muted>
                                        <source src="{{ data.overall_result.overall_video }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                            {% endif %}
                        {% endif %}

                        {% if method in ['physiological', 'visual_artifacts', 'deep_learning', 'deep_learning_static'] and data.face_results %}
                            <div class="face-summary">
                                <h3>Face Detection Summary</h3>
                                <div class="face-grid">
                                    {% for face in data.face_results %}
                                        <div class="face-summary-card">
                                            <div class="face-id">Face #{{ face.track_id }}</div>
                                            <div class="face-result" style="color: {% if face.result == 'Real' %}#10b981{% elif face.result == 'Fake' %}#ef4444{% else %}#f59e0b{% endif %};">
                                                {{ face.result }}
                                            </div>
                                            {% if face.real_count is defined and face.fake_count is defined %}
                                                <div class="face-counts">
                                                    Real: {{ face.real_count }} | Fake: {{ face.fake_count }}
                                                </div>
                                            {% endif %}
                                            {% if face.confidence is defined %}
                                                <div class="face-confidence">
                                                    Deepfake Probability: {{ face.confidence }}%
                                                </div>
                                            {% endif %}
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>

                            {% if data.output_video %}
                                <div class="video-analysis">
                                    <h3>Analyzed Video</h3>
                                    <video class="analysis-video" controls autoplay loop muted>
                                        <source src="{{ data.output_video }}" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </main>

    <footer>
        <div id="footer-placeholder"></div>
    </footer>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
     <script src="../static/js/result-html.js"></script>
</body>
</html>